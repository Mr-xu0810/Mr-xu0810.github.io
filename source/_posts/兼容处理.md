---
title: 兼容处理
date: 2021-05-21 21:01:43
author: Mr-xu
img: /images/4.jpg
top: false
cover: false
summary: 记录遇到的兼容问题
categories: 移动端
tags:
  - 兼容
---

# 兼容问题记录
>在进行h5或者移动端开发的时候，都会遇到一些兼容性的问题，把我自己遇到的部分记录一下

+ input文字不居中的情况
  input中文字会出现偏上的现象，一般设置line-height=height可以居中，但移动端这样设置后依然可能存在偏上，需要直接设置line-height: normal

+ 固定定位输入框，键盘弹起时会遮挡输入框
  在页面需要将输入框固定在底部时，键盘弹起会盖住输入框，处理方法是：聚焦时将输入框设置为静态定位，这样就会被键盘顶上去，当失去焦点时重新设置定位

+ 1像素的处理
  伪类+transform的形式   --写法繁琐
  ``` javascript
    <div class="box"></div> 
    // css
    .box {
      width: 200px;
      height: 200px;
      position: relative;
      border-radius: 10px;
    }
    .box::after {
      content: "";
      box-sizing: border-box;
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      border: 1px solid gray;
      border-radius: 10px;
    }
    // 根据像素比 处理
    @media (-webkit-min-device-pixel-ratio: 2) {
      .border-1px::after {
          width: 200%;
          height: 200%;
          transform: scale(0.5);
          transform-origin: 0 0;
      }
    }
     @media (-webkit-min-device-pixel-ratio: 2.5) {
        .border-1px::after {
            width: 250%;
            height: 250%;
            -webkit-transform: scale(.4);
        }
    }
    @media (-webkit-min-device-pixel-ratio: 2.75) {
        .border-1px::after {
            width: 275%;
            height: 275%;
            -webkit-transform: scale(1 / 2.75);
        }
    }
    @media (-webkit-min-device-pixel-ratio: 3) {
        .border-1px::after {
            width: 300%;
            height: 300%;
            transform: scale(1 / 3);
            -webkit-transform: scale(1 / 3);
        }
    }
  ```

  border-image形式  --视觉效果不好，可能会模糊
  ``` javascript
    .border{ 
        border-width: 1px 0px;
        -webkit-border-image: url("border.png") 2 0 stretch;
        border-image: url("border.png") 2 0 stretch;
    }
  ```

  box-shadow形式   --颜色不好控制
  ``` javascript
    .border {
      box-shadow: 0 1px 1px -1px rgba(0, 0, 0, 0.5);
      -webkit-box-shadow: 0 1px 1px -1px rgba(0, 0, 0, 0.5);
    }
  ```

+ 移动端点击300ms延迟解决
  由于需要区分单击事件和双击缩放，所以在用户第一次点击后，会保持一段时间，如果用户在这段时间内未进行下次点击，即进行单击处理
  元素的事件顺序： touchstart --> touchmove --> touchend --> click， 触摸事件在点击事件先执行，即可通过绑定触摸事件来取消点击延迟问题

  300ms的延时会引发点击穿透问题，会触发到下层相同位置的元素的事件
  解决方案：
    1.下层元素本身无click事件,没有input select a标签,统一使用touch事件；
    2.在上方元素的touchend事件回调函数中,阻止后续触发默认事件 e.preventDefault()