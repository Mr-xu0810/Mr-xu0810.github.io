---
title: 项目问题记录
date: 2021-12-11 17:59:48
author: Mr-xu
img: /images/1.jpg
top: false
cover: false
summary: 项目中遇到的问题记录
tags:
  - js
---

# 项目中遇到的问题记录

## pc分辨率自适应
> vue PC页面不同分辨率自适应，新项目直接配置rem来实现，已有项目通过插件将px转ren的形式来实现（postcss-px2rem及px2rem-loader）

1. 安装插件

   ```bash
   npm install postcss-px2rem px2rem-loader --save
   ```

2. 创建并编写适配文件

   ```javascript
   const baseSize = 16
   
   function setRem() {
   	// 当前页面相对于1920宽的缩放比例
   	const scale = document.documentElement.clientWidth / 1920
   	// 设置页面根节点字体大小（“Math.min(scale, 2)” 指最高放大比例为2
       document。documentElement.style.fontSize = baseSize * Math.min(scale, 1) + 'px'
   }
   
   setRem()
   
   window.onresize = function() {
   	setRem()
   }
   ```

3. 引入适配文件

   ```javascript
   // main.js 中引入
   import 'rem.js'
   ```

4. vue.config.js 中配置插件

   ```
   // 引入等比适配插件
   const px2rem = require('postcss-px2rem')
   
   // 配置基本大小
   const postcss = px2rem({
     // 基准大小 baseSize，需要和rem.js中相同
     remUnit: 16
   })
   
   // 使用等比适配插件
   module.exports = {
     lintOnSave: true,
     css: {
       loaderOptions: {
         postcss: {
           plugins: [
             postcss
           ]
         }
       }
     }
   }
   ```

## 禁止页面缩放

> ps:  项目需要使页面不进行缩放， 实现如下（<font color=orange size=3>*如非必须请不要干涉用户操作*</font>）
>
> 在chrome、ie下监听的是mousewheel   火狐则不存在该方法，需要监听DOMMouseScroll方法

```javascript
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey === true || e.metaKey === true) && (e.which === 61 || e.which === 107 || e.which === 173 || e.which === 109 || e.which === 187 || e.which === 189)) {
        e.preventDefault()
    }
}, false)
// chrome  ie  360
window.addEventListener('mousewheel', function(e) {
    if (e.ctrlKey === true || e.metaKey) {
        e.preventDefault()
    }
}, { passive: false })
// firefox
window.addEventListener('DOMMouseScroll', function(e) {
    if (e.ctrlKey === true || e.metaKey) {
        e.preventDefault()
    }
}, { passive: true })
```

## element tree在固定宽度的情况下无法产生横向的进度条
> 设置tree的样式
```css
.el-tree>.el-tree-node {
  display: inline-block;
  min-width: 100%;
}
```